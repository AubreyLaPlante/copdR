<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>howto_copdr • copdr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="howto_copdr">
<meta property="og:description" content="copdr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">copdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/howto_copdr.html">howto_copdr</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>howto_copdr</h1>
            
      
      
      <div class="hidden name"><code>howto_copdr.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">copdr</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-are-copds-and-why-are-they-used-to-analyze-earthquakes">1. What are COPDs and why are they used to analyze earthquakes?<a class="anchor" aria-label="anchor" href="#what-are-copds-and-why-are-they-used-to-analyze-earthquakes"></a>
</h2>
<p>First of all, what are cumulative offset probability distribution
(COPD) functions, and how are they used in earthquake offset analyses?
In general, when scientists are trying to determine the size of past
earthquakes, they need to know how much slip occurred in a single
earthquake. This is because the magnitude of total offset is correlated
to the moment magnitude/energy released during an earthquake (e.g., the
Richter Scale). To determine the amount of total offset that occurs
during earthquakes, we must find linear features that intersect the
surface trace of a fault, and reconstruct the feature by ‘backslipping’
or undoing the motion that deformed that originally-linear feature.
There are fantastic historic examples of roads and fences being split
apart by earthquakes, but we may also use naturally sub-linear geologic
features such as glacier moraines, streams, and ridges.</p>
<p>In Figure 1, a single point bar is right-laterally offset by a single
fault trace.</p>
<div class="figure">
<img src="https://github.com/AubreyLaPlante/external_figs/blob/main/RLoffset.png?raw=true" alt="Figure 1: A right-laterally offset bar in an alluvial fan. Dashed white lines show the bar edges, the red line indicates the fault trace, and yellow arrows show the sense of slip. Panamint Valley, California. Modified from LaPlante (2022)." width="100%"><p class="caption">
Figure 1: A right-laterally offset bar in an alluvial fan. Dashed white
lines show the bar edges, the red line indicates the fault trace, and
yellow arrows show the sense of slip. Panamint Valley, California.
Modified from LaPlante (2022).
</p>
</div>
<hr>
<p>Assuming that this was one feature originally, we can measure how
much one side of the bar moved relative to the other by measuring the
distance between the southern edge of the western bar segment and the
southern edge of the eastern bar segment. We can also measure the
distance between the northern edge of the western bar segment and the
northern edge of the eastern bar segment. There is also the crest of the
bar, representing its maximum height at a central E-W axis, that
provides another lateral offset measurement. As you might imagine, there
is considerable uncertainty within where these bar edges and crest lines
are, and this can change the measured lateral offset of this feature,
depending on scientific interpretations. Confused yet?</p>
<p>Figure 2 is a graphical representation of a right-laterally offset
bar, similar to the geomorphic feature shown in Figure 1. What Figure 2d
shows is that when we estimate the amount of slip on a fault from an
offset feature by ‘backslipping’ that feature, we get a most-likely
value (where correlation = 1), bounded by a maximum and a minimum slip
value (where correlation = 0). This curve approximates a Gaussian
distribution. The width of this Gaussian distribution, or normal
probability distribution function (PDF), is related to the uncertainty
of the offset measurement. We can quantify that uncertainty in a number
of ways including the standard deviation, the coefficient of variation,
or confidence scaling. Confidence scaling can vary across different
scientific studies, and is used to more-strongly weight the more
sharply-defined piercing points (linear features) when we combine/sum
multiple PDFs together to create a COPD.</p>
<div class="figure">
<img src="https://github.com/AubreyLaPlante/external_figs/blob/main/LaPlante2022_PDFs.png?raw=true" alt="Figure 2: A schematic diagram showing the reconstruction, or 'backslipping', of a point bar. (a) The fault (solid line) and the geomorphic profile of the bar on the western side of the fault (A-A’) and the eastern side of the fault (B-B’). (b) Topographic profiles A-A’ and B-B’ before lateral and vertical shift. (c) Topographic profiles A-A’ and B-B’ after lateral and vertical shift. (d) By mathematically restoring the offset geomorphic marker, a Matlab code generates a lateral shift-correlation plot that predicts a most likely displacement for a piercing point. The vertical offset is found by finding the amount of vertical shift necessary to achieve a correlation coefficient of 1 on the lateral profile shift line. Figure from LaPlante (2022)." width="100%"><p class="caption">
Figure 2: A schematic diagram showing the reconstruction, or
‘backslipping’, of a point bar. (a) The fault (solid line) and the
geomorphic profile of the bar on the western side of the fault (A-A’)
and the eastern side of the fault (B-B’). (b) Topographic profiles A-A’
and B-B’ before lateral and vertical shift. (c) Topographic profiles
A-A’ and B-B’ after lateral and vertical shift. (d) By mathematically
restoring the offset geomorphic marker, a Matlab code generates a
lateral shift-correlation plot that predicts a most likely displacement
for a piercing point. The vertical offset is found by finding the amount
of vertical shift necessary to achieve a correlation coefficient of 1 on
the lateral profile shift line. Figure from LaPlante (2022).
</p>
</div>
<hr>
<p>That finally brings us to COPDs. COPDs are the normal functions, the
PDFs, summed together for many linear features across the entire length
of a fault zone. One commonly used example is the well-defined COPD
plots from the Carrizo Plain segment of the San Andreas fault in
California, US. Similar to the example shown above, Zielke et al.,
(2010) illustrates one example of right-lateral offset of a single
drainage. In this example, the PDF peak occurs at around 5 m, with an
uncertainty of ± ~0.6 - 0.7 m.</p>
<div class="figure">
<img src="https://github.com/AubreyLaPlante/external_figs/blob/main/Zielke2010_channels.png?raw=true" alt="Figure 3: A single offset displacement marker from the Carrizo segment of the San Andreas fault, in southern California. (a) The aerial view of the offset channel from a digital elevation model. (b) Red and blue cross sections of the offset channel, parallel to the fault plane. (c) The resulting right-lateral offset PDF for this channel. Figure from Zielke et al., (2010)." width="100%"><p class="caption">
Figure 3: A single offset displacement marker from the Carrizo segment
of the San Andreas fault, in southern California. (a) The aerial view of
the offset channel from a digital elevation model. (b) Red and blue
cross sections of the offset channel, parallel to the fault plane. (c)
The resulting right-lateral offset PDF for this channel. Figure from
Zielke et al., (2010).
</p>
</div>
<hr>
<p>Zielke et al., (2010), combines dozens of PDFs along this segment of
the San Andreas fault. This combined/summed PDF plot (Figure 4b) is the
cumulative offset probability distribution (COPD) function. Each of
these individual PDFs have different local offset maxima because each
offset marker records a different number of earthquakes. This is
consistent with what we would expect, such that the oldest geomorphic
features have been displaced by many earthquakes, while the youngest
generations of Holocene alluvium may have only experienced the most
recent earthquake. Assuming that earthquakes on the southern San Andreas
fault are perfectly elastic, we would also expect to see regular PDF
peak spacing from subsequent earthquakes producing the same total
magnitudes of slip.</p>
<div class="figure">
<img src="https://github.com/AubreyLaPlante/external_figs/blob/main/Zielke2010_carrizo.png?raw=true" alt="Figure 4: Individual PDFs from a ~50 km extent of the Carrizo fault segment of the southern San Andreas fault. All PDFs are summed together to create a COPD plot, which is useful in interpreting the magnitude of total slip in past earthquakes. (a) Individual PDFs are plotted in space, with distance from north to south on the X axis and total offset magnitude on the Y axis. PDFs are colored by average slip magnitude, with orange representing the clustering of the least amount of slip and light blue representing the clustering of the largest magnitude of slip. (b) All PDFs are summed together to isolate clusters of total offset magnitudes. Theoretically, each peak represents the displacement associated with a different number of earthquakes, assuming that each earthquake produced the same magnitude of slip. Therefore, orange curves represent one earthquake, purple curves represent two earthquakes, yellow represents three earthquakes, etc. Figure from Zielke et al., (2010)." width="100%"><p class="caption">
Figure 4: Individual PDFs from a ~50 km extent of the Carrizo fault
segment of the southern San Andreas fault. All PDFs are summed together
to create a COPD plot, which is useful in interpreting the magnitude of
total slip in past earthquakes. (a) Individual PDFs are plotted in
space, with distance from north to south on the X axis and total offset
magnitude on the Y axis. PDFs are colored by average slip magnitude,
with orange representing the clustering of the least amount of slip and
light blue representing the clustering of the largest magnitude of slip.
(b) All PDFs are summed together to isolate clusters of total offset
magnitudes. Theoretically, each peak represents the displacement
associated with a different number of earthquakes, assuming that each
earthquake produced the same magnitude of slip. Therefore, orange curves
represent one earthquake, purple curves represent two earthquakes,
yellow represents three earthquakes, etc. Figure from Zielke et al.,
(2010).
</p>
</div>
<hr>
<p>In Figure 4b, we see peaks in the COPD plot of 5m, 10m, 15m, and so
on. This is useful, and consistent with our assumptions. It appears that
each earthquake on the Carrizo segment produces about ~5m of
right-lateral strike slip motion. Using this number for average
displacement we can use scaling relationships (Wells and Coppersmith,
1994) to determine that this amount of average displacement corresponds
to a rupture length of ~136 km and an earthquake magnitude of Mw ~7.7.
COPDs can be really useful to estimate future seismic hazards!</p>
<hr>
</div>
<div class="section level2">
<h2 id="introduction-to-cumulative-offset-probability-distribution-functions-in-r-copdr">2. Introduction to Cumulative Offset Probability Distribution
functions in R (copdr)<a class="anchor" aria-label="anchor" href="#introduction-to-cumulative-offset-probability-distribution-functions-in-r-copdr"></a>
</h2>
<p>This code is meant to import probability distribution functions
(PDFs), i.e. Gaussian curves, and combine them in a modicum of ways for
the user, based on several filters to remove the noisy PDFs or PDFs with
high uncertainties (i.e. large standard deviations, high coefficient of
variation, etc). These PDFs are produced from LaDiCaoz, a Matlab program
that allows you to ‘backslip’ offset on a fault from digital elevation
models (DEMs) or digital surface models (DSMs). It is a lot of acronyms,
but stay with me.</p>
<div class="section level3">
<h3 id="load-in-data">2.1 Load in data<a class="anchor" aria-label="anchor" href="#load-in-data"></a>
</h3>
<p>First, you need to make sure that the full PDF dataset and its
metadata CSV is in a folder in your working directory. The default
dataset is pre-coded for your convenience.</p>
<div class="section level4">
<h4 id="a--user-defined-inputs">a. <em>User-defined inputs</em><a class="anchor" aria-label="anchor" href="#a--user-defined-inputs"></a>
</h4>
<p>There are three global variables that the user can set:</p>
<ol style="list-style-type: decimal">
<li>directory - this is where all your data are located.<br>
</li>
<li>folder_name - this is the folder_name in the directory that holds
all the PDF .mat files.<br>
</li>
<li>csv_name - this is the reference metadata that has latitude,
longitude, total, lateral, or vertical offset values, standard deviation
of offset measurements, confidence rankings, and any other data that you
collected. You may see example.csv or example.xlsx to see how this
metadata should be formatted. However, this data must be in .csv form
before loading it in.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">directory</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"copdr"</span><span class="op">)</span></span>
<span><span class="va">folder_name</span> <span class="op">&lt;&lt;-</span> <span class="st">"example_mat"</span></span>
<span><span class="va">csv_name</span> <span class="op">&lt;&lt;-</span> <span class="st">"example.csv"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b--importing-the-data">b. <em>Importing the data</em><a class="anchor" aria-label="anchor" href="#b--importing-the-data"></a>
</h4>
<p>This first part of the code does the following:</p>
<ol style="list-style-type: decimal">
<li>file2vect() takes the folder_name set above (i.e. ‘example_mat’) in
the working directory and makes a vector of all the file names with the
file format ‘.mat’.<br>
</li>
<li>mat2list() creates a list with three matrices, 1. lateral, 2.
vertical, 3. total offset.</li>
<li>Imports the metadata from a reference .csv file. See “example.csv”
or “example.xlsx” in the external data section for how this reference
metadata should be formatted.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">backslip_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/file2vect.html">file2vect</a></span><span class="op">(</span><span class="va">directory</span>, <span class="va">folder_name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">backslip_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mat2list.html">mat2list</a></span><span class="op">(</span><span class="va">directory</span>,<span class="va">folder_name</span>,<span class="va">backslip_names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">backslip_csv</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">directory</span>,<span class="va">csv_name</span><span class="op">)</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="data-pre-processing">3. Data pre-processing<a class="anchor" aria-label="anchor" href="#data-pre-processing"></a>
</h2>
<div class="section level3">
<h3 id="visualize-the-raw-data">3.1. Visualize the raw data<a class="anchor" aria-label="anchor" href="#visualize-the-raw-data"></a>
</h3>
<p>This code plots all the PDFs data on a default coordinate axis, to
check that the data loaded in correctly. This is NOT the COPD plot yet,
as we have not summed the PDFs together, so the Y-axis is still
probability with a max of 1. With the default dataset, the axes are
larger than the extent of the data. You should not see any negative
probabilities. For now, ignore the sign of the lateral and vertical
offset magnitudes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="st">"lateral"</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/plot-raw-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="st">"vertical"</span>,simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/plot-raw-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="st">"total"</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/plot-raw-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="clip-raw-data-and-plot">3.2 Clip raw data and plot<a class="anchor" aria-label="anchor" href="#clip-raw-data-and-plot"></a>
</h3>
<p>Sometimes we may have datasets that are larger than the extent that
we would like to analyze. For example, in some cases we may only want to
look at small values of displacement, so we would need to clip out any
data that is larger than a threshold value. With the default dataset,
there are extra zeros on either side of each PDF curve, beyond the
maximum and minimum values. These extra zeros are unnecessary and may
make it difficult when combining the datasets, if each PDF has different
lengths of probability vectors. So, we will uniformly clip the PDFs to
remove anything unnecessary for future analysis.</p>
<div class="section level4">
<h4 id="a--user-defined-inputs-1">a. <em>User-defined inputs</em><a class="anchor" aria-label="anchor" href="#a--user-defined-inputs-1"></a>
</h4>
<p>Use the graphs from 2.1 to clip your dataset.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lat_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     lat_x_min <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>,</span>
<span>     lat_x_max <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     lat_y_min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     lat_y_max <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vert_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     vert_x_min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>     vert_x_max <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     vert_y_min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     vert_y_max <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">total_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     total_x_min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     total_x_max <span class="op">=</span> <span class="fl">5</span>,</span>
<span>     total_y_min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     total_y_max <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span>  </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b--clipping-the-data">b. <em>Clipping the data</em><a class="anchor" aria-label="anchor" href="#b--clipping-the-data"></a>
</h4>
<p>The following code clips each of the datasets (lateral, vertical,
total) by the boundaries defined above, and plots the new, clipped
datasets.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#clip x limits of data</span></span>
<span><span class="va">backslip_data_clip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     backslip_lat <span class="op">=</span> <span class="fu"><a href="../reference/data.clip.html">data.clip</a></span><span class="op">(</span><span class="va">backslip_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="st">"lateral"</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     backslip_vert <span class="op">=</span> <span class="fu"><a href="../reference/data.clip.html">data.clip</a></span><span class="op">(</span><span class="va">backslip_data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="st">"vertical"</span>,<span class="va">vert_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">vert_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     backslip_tot <span class="op">=</span> <span class="fu"><a href="../reference/data.clip.html">data.clip</a></span><span class="op">(</span><span class="va">backslip_data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="st">"total"</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#plot clipped data</span></span>
<span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data_clip</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="st">"lateral"</span>, </span>
<span>        <span class="va">lat_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span><span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/clip-functions-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data_clip</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="st">"vertical"</span>, </span>
<span>        <span class="va">vert_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">vert_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">vert_limits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">vert_limits</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span><span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/clip-functions-2.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data_clip</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="st">"total"</span>, </span>
<span>        <span class="va">total_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span><span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/clip-functions-3.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="confidence-scaling">3.3 Confidence Scaling<a class="anchor" aria-label="anchor" href="#confidence-scaling"></a>
</h3>
<p>This code scales each PDF by a confidence value. These confidence
values are specific to the dataset, where 1 is the maximum confidence
and your largest value is the lowest confidence. Confidence scales vary
widely, but are generally a study-specific ranking involving many
qualitative evaluations of how likely an offset geomorphic feature is
representative of an accurate and precise earthquake displacement value.
This may involve a relative ranking of how degraded a geomorphic feature
is, the angle that it intersects a fault trace (higher angles are
better), or whether there appears to be post-earthquake modification by
streams or human activity.</p>
<p>In this dataset, 3 is the lowest confidence. The code is set up to
accommodate any confidence scale (1 to 3, 1 to 5, 1 to 10, etc). If your
confidence values are flipped in the reference metadata, such that 1 is
the lowest confidence value, you will need to invert the values in your
metadata csv.</p>
<div class="section level5">
<h5 id="developer-note-to-self">
<em>Developer note to self:</em><a class="anchor" aria-label="anchor" href="#developer-note-to-self"></a>
</h5>
<blockquote>
<p>Currently, this code is set up to perform confidence scaling on the
clipped dataset from the previous section, and output a Cscaled dataset.
In a future version of this code, each of these data-filtering and
scaling sections will be optional, and be set up to perform confidence
scaling on the backslip_data, replacing the input dataset with the
output dataset from each section.</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="a--user-defined-inputs-2">a. <em>User-defined inputs</em><a class="anchor" aria-label="anchor" href="#a--user-defined-inputs-2"></a>
</h4>
<p>Specify which column of the metadata .csv corresponds to the
confidence rankings, and the total number of offset geomorphic features.
This N_observations number should be equal to the number of .mat files
in your input folder_name. The default input dataset has 205 independent
offset measurements.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">confidence_column</span> <span class="op">=</span> <span class="fl">9</span></span>
<span><span class="va">N_observations</span> <span class="op">=</span> <span class="fl">205</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b--confidence-scaling-the-data">b. <em>Confidence-scaling the data</em><a class="anchor" aria-label="anchor" href="#b--confidence-scaling-the-data"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#scale the data by confidence values and put in a new Cscale list</span></span>
<span><span class="va">backslip_data_Cscale</span> <span class="op">&lt;-</span> <span class="va">backslip_data</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">backslip_data_Cscale</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conf.scale.html">conf.scale</a></span><span class="op">(</span><span class="va">backslip_data_clip</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="va">backslip_csv</span>, <span class="va">confidence_column</span>, <span class="va">N_observations</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#plot confidence-scaled data</span></span>
<span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data_Cscale</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="st">"lateral"</span>, </span>
<span>             <span class="va">lat_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">lat_limits</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span><span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/confidence-scaling-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data_Cscale</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="st">"vertical"</span>, </span>
<span>        <span class="va">vert_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">vert_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">vert_limits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">vert_limits</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span><span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/confidence-scaling-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPDF.html">plotPDF</a></span><span class="op">(</span><span class="va">backslip_data_Cscale</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="st">"total"</span>,</span>
<span>        <span class="va">total_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, simplify <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span><span class="op">+</span> <span class="va">ThemeMain</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/confidence-scaling-3.png" width="700"></p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="coefficient-of-variation-cov-calculation">3.4 Coefficient of variation (COV) calculation<a class="anchor" aria-label="anchor" href="#coefficient-of-variation-cov-calculation"></a>
</h3>
<p>The coefficient of variation (COV) is the ratio of the standard
deviation (<span class="math inline">\(\sigma\)</span>) to the sample
mean (<span class="math inline">\(\mu\)</span>) for a single PDF and is
a statistical measure of the relative dispersion (also called scatter,
or spread) of the dataset.</p>
<p><span class="math display">\[COV = \frac{\sigma}{\mu}\]</span></p>
<p>This parameter is an alternative to standard deviation to measure the
relative uncertainty of offset geomorphic features. One disadvantage of
filtering by COV is that if standard deviations are relatively constant
across a dataset, distributions with smaller means will tend to have
larger COVs. Therefore, removing PDFs with larger COVs may lessen, or
remove entirely, peaks at displacement means &lt; 1 m. Generally,
standard deviation tends to be a more reliable measure of relative
uncertainty for smaller magnitude offsets, while coefficient of
variation tends to be a more relable measure of relative uncertainty for
larger magnitude offsets. In any case, it is useful to have this
measurement of dispersion in your reference csv.</p>
<p>The master reference CSV “backslip_csv” should have 4-6 columns for
displacement statistics including:<br>
- lateral mean<br>
- lateral standard deviation - vertical mean<br>
- vertical standard deviation<br>
- total mean<br>
- total standard devation<br></p>
<p>The inputs for this section will need to be the columns of offset
data. The following code calculates the coefficient of variation, which
is the standard deviation divided by the mean. I used lateral in my
example because in the example data, vertical displacement is poorly
resolved and of very small magnitude.</p>
<div class="section level4">
<h4 id="user-defined-inputs">
<em>User-defined inputs</em><a class="anchor" aria-label="anchor" href="#user-defined-inputs"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># these are the column numbers corresponding to this data in the reference csv</span></span>
<span><span class="va">columnNums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     lat_mean <span class="op">=</span> <span class="fl">13</span>,</span>
<span>     lat_stdev <span class="op">=</span> <span class="fl">14</span>,</span>
<span>     vert_mean <span class="op">=</span> <span class="fl">15</span>,</span>
<span>     vert_stdev <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     total_mean <span class="op">=</span> <span class="fl">17</span>,</span>
<span>     total_stdev <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="calculate-cov-values">
<em>Calculate COV values</em><a class="anchor" aria-label="anchor" href="#calculate-cov-values"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">backslip_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.cov.html">calc.cov</a></span><span class="op">(</span><span class="va">backslip_csv</span>,<span class="st">"lateral"</span>, <span class="va">columnNums</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">columnNums</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">backslip_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.cov.html">calc.cov</a></span><span class="op">(</span><span class="va">backslip_csv</span>,<span class="st">"vertical"</span>,<span class="va">columnNums</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">columnNums</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">backslip_csv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.cov.html">calc.cov</a></span><span class="op">(</span><span class="va">backslip_csv</span>,<span class="st">"total"</span>,<span class="va">columnNums</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, <span class="va">columnNums</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="filters">4. Filters<a class="anchor" aria-label="anchor" href="#filters"></a>
</h2>
<p>The goal of filtering PDFs prior to summing them together is to find
where clusters of data produce the largest, most statistically
significant peaks. In selecting certain PDFs for COPD analysis, we want
to minimize the amount of dispersion and uncertainty that could obscure
the peaks associated earthquake magnitudes. However, we do not want to
remove enough data that we begin to introduce statistically
insignificant peaks, such that we over-interpret the number of
earthquakes. We will tackle the statistical significance part with an
optimization problem later on in the code.</p>
<p>As discussed above in section 3.4, there are advantages and
disadvantages to filtering data through a large COV filter. There are
also advantages and disadvantages to using only standard deviation
filters. One problem with removing PDFs with larger standard deviations
is that this filtering method will produce a bias towards removing
larger displacements in older fan surfaces, due to the time-degradation
of that geomorphic surface and an increase in uncertainty of the
offset.</p>
<p>Ultimately, it is your job to pick and choose the filters that
produce the most statistically significant peaks. This section contains
<em>(it will eventually contain)</em> filters for standard deviation,
coefficient of variation, geomorphic-age, and piercing point type. Each
of these filters will work via the following steps:</p>
<p>-User-defined set of criteria for a single category/column of the
reference metadata .csv (geomorphic feature, standard deviation, etc)
-Create a clipped metadata .csv with only the values/characteristics
indicated by the filter (that meet a set of critera) -Clip the input
offset matrix to include only filenames in the clipped metadata -Sum
these PDFs together to create a COPD</p>
<div class="section level3">
<h3 id="cov-filters">4.1 COV filters<a class="anchor" aria-label="anchor" href="#cov-filters"></a>
</h3>
<div class="section level4">
<h4 id="a--user-defined-inputs-3">a. User-defined inputs<a class="anchor" aria-label="anchor" href="#a--user-defined-inputs-3"></a>
</h4>
<p>Specify the threshold values of COV that you want to remove from the
input matrices.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#these are the COV values you want to filter for</span></span>
<span><span class="va">COV_filter_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.10</span>,<span class="fl">.30</span>, by<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b--filter-pdf-data-by-threshold-cov-values">b. Filter PDF data by threshold COV values<a class="anchor" aria-label="anchor" href="#b--filter-pdf-data-by-threshold-cov-values"></a>
</h4>
<p>The following code creates the clipped reference .csv(s) for each of
the threshold values set above, and then filters the input matrix
(<strong>note: <em>currently, the Cscaled dataset</em></strong> ) using
the clipped .csv metadata.</p>
<p>The code then produces the COPD plots.</p>
</div>
<div class="section level4">
<h4 id="developers-note">
<em>Developer’s note</em><a class="anchor" aria-label="anchor" href="#developers-note"></a>
</h4>
<blockquote>
<p>This section is very code-heavy and I am in progress of turning this
into a function. ideally, the user will be able to plot every
COV-threshold filtered copd on the same figure, so that they can compare
which filter provides the best results to analyze peaks.</p>
</blockquote>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">latPlot</span> <span class="op">&lt;-</span> <span class="va">vertPlot</span> <span class="op">&lt;-</span> <span class="va">totPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COV_filter_vals</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">latPlot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCOPD.html">plotCOPD</a></span><span class="op">(</span><span class="va">lat_cov2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="st">"lateral"</span>,<span class="va">COV_filter_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">lat_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lat_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">ThemeMain</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COV_filter_vals</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">vertPlot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCOPD.html">plotCOPD</a></span><span class="op">(</span><span class="va">vert_cov2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="st">"vertical"</span>,<span class="va">COV_filter_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">vert_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">vert_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">ThemeMain</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COV_filter_vals</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">totPlot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCOPD.html">plotCOPD</a></span><span class="op">(</span><span class="va">total_cov2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="st">"total"</span>,<span class="va">COV_filter_vals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">total_limits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">total_limits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">ThemeMain</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COV_filter_vals</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">latPlot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/plot-cov-filter-1.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-2.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-3.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-4.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-5.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COV_filter_vals</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">vertPlot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/plot-cov-filter-6.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-7.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-8.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-9.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-10.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">COV_filter_vals</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">totPlot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="howto_copdr_files/figure-html/plot-cov-filter-11.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-12.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-13.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-14.png" width="700"><img src="howto_copdr_files/figure-html/plot-cov-filter-15.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#plotCOPD(lat_cov2[[5]] ,"lateral", lat_limits[[1]], lat_limits[[2]])</span></span>
<span><span class="co">#plotCOPD(vert_cov2[[5]] ,"vertical", vert_limits[[1]],vert_limits[[2]])</span></span>
<span><span class="co">#plotCOPD(total_cov2[[5]] ,"total", total_limits[[1]],total_limits[[2]])</span></span></code></pre></div>
<p>Which COV filter produces the best peaks, without removing too much
of the original data?</p>
</div>
<div class="section level4">
<h4 id="developers-note-1">
<em>Developer’s note</em><a class="anchor" aria-label="anchor" href="#developers-note-1"></a>
</h4>
<blockquote>
<p>I want to add an ‘n = __’ on the graphs, so the user can see how many
total PDF observations are summed together for each COPD.</p>
</blockquote>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aubrey LaPlante.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
